<?php

class Overall_m extends MY_Model{
	
	public function __construct()
	{
		parent::__construct();
		
	}
		

	//public function overall_logged($hostname, $username, $password)
	public function overall_logged()
	{
		//$sha1_password = sha1($password);


		$query_str="SELECT total,mtb,neg,rif
FROM(
SELECT 

sum(CASE WHEN cond='1' THEN 1 ELSE 0 END) as total,

sum( CASE WHEN Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS mtb,

sum(CASE WHEN Test_Result =   'MTB NOT DETECTED'  THEN 1 ELSE 0 END) as neg,

sum( CASE WHEN   Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  


FROM sample)x" ;	

$result = $this->db->query($query_str);
$overall = $result->result_array();




/* ****************************************************
$tnat=totalTestsNational($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate);
$tt=totalTestsByOutcome($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate) ;
$age=totalTestsByAge($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate); 
$gender=totalTestsByGender($filter, $currentmonth, $currentyear, $fromfilter, $tofilter, $fromdate, $todate);
$hstatus=totalTestsByHStatus($filter, $currentmonth, $currentyear, $fromfilter, $tofilter, $fromdate, $todate);
$ptype=totalTestsByPtype($filter, $currentmonth, $currentyear, $fromfilter, $tofilter, $fromdate, $todate);*/


$returnable = array('overall'=>$overall);
return $returnable;

		}	


	function totalTestsNational($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)	
{

if ($filter==0) //last submission
	  {
	  $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,
sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

	  }
	  elseif ($filter==1)//last 6 months $fromdate$todate
	  {
	  $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
	  }
	  elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
	  {
	  	  $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
	  }
	    elseif ($filter==3)//month/year
	  {
	   $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
 	  }
	    elseif ($filter==4)//year only
	  {
	 $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
	  }
	    elseif ($filter==7) //last 6 months $fromdate$todate
	  {
	  	  $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
	  }
	  elseif ($filter==8) //all
	  {
	  	  $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE cond='1'  ";
	  }

	

$result = $this->db->query($query_str);

$tnat = $result->result_array();

$returnable = array('tnat'=>$tnat);
return $returnable;


	


}


public function totalTestsByOutcome($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
{

if ($filter==0) //last submission
	  {
	   $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ),
	   sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  
       FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

	  }
	  elseif ($filter==1)//last 6 months $fromdate$todate
	  {
	   $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ),
	   sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  
       FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
	  }
	  elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
	  {
	  	   $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ),
	   sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  
       FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
	  }
	    elseif ($filter==3)//month/year
	  {
	    $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ),
	   sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  
       FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
 	  }
	    elseif ($filter==4)//year only
	  {
	   $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ),
	   sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  
       FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
	  }
	    elseif ($filter==7) //last 6 months $fromdate$todate
	  {
	   $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ),
	   sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  
       FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
	  }
	    elseif ($filter==8) //all
	  {
	   $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ),
	   sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END),
	   sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  
       FROM  sample WHERE cond='1'  ";
	  }


$result = $this->db->query($query_str);

$tt = $result->result_array();

$returnable = array('t'=>$tt);
return $returnable;




}


public function totalTestsByAge($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
{
	if ($filter==0) //last submission
	  {
	   $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

	  }
	  elseif ($filter==1)//last 6 months $fromdate$todate
	  {
	   $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
	  }
	  elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
	  {
	  	   $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
	  }
	    elseif ($filter==3)//month/year
	  {
	    $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
 	  }
	    elseif ($filter==4)//year only
	  {
	  $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
	  }
	    elseif ($filter==7) //last 6 months $fromdate$todate
	  {
	  	   $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
	  } elseif ($filter==8) //all
	  {
	  	   $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE cond='1'  ";
	  }



$result = $this->db->query($query_str);

$age = $result->result_array();

$returnable = array('age'=>$age);
return $returnable;






}

public function totalTestsByGender($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
{

	if ($filter==0) //last submission
	  {
	   $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

	  }
	  elseif ($filter==1)//last 6 months $fromdate$todate
	  {
	   $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
	  }
	  elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
	  {
	  	   $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
	  }
	    elseif ($filter==3)//month/year
	  {
	    $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
 	  }
	    elseif ($filter==4)//year only
	  {
	  $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
	  }
	    elseif ($filter==7) //last 6 months $fromdate$todate
	  {
	  	   $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
	  }
	     elseif ($filter==8) //all
	  {
	  	   $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE cond='1'  ";
	  }


$result = $this->db->query($query_str);

$gender = $result->result_array();

$returnable = array('gender'=>$gender);
return $returnable;



}




public function totalTestsByHStatus($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
	  {
	  if ($filter==0) //last submission
	  {
	   $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

	  }
	  elseif ($filter==1)//last 6 months $fromdate$todate
	  {
	   $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
	  }
	  elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
	  {
	  	   $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
	  }
	    elseif ($filter==3)//month/year
	  {
	    $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
 	  }
	    elseif ($filter==4)//year only
	  {
	  $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
	  }
	    elseif ($filter==7) //last 6 months $fromdate$todate
	  {
	  	   $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
	  }
	  elseif ($filter==8) //all
	  {
	  	   $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE cond='1'  ";
	  }

$result = $this->db->query($query_str);

$hstatus = $result->result_array();

$returnable = array('hstatus'=>$hstatus);
return $returnable;
}


public function totalTestsByPtype($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
{

	if ($filter==0) //last submission
	  {
	  $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample  WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

	  }
	  elseif ($filter==1)//last 6 months $fromdate$todate
	  {
	   $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
	  }
	  elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
	  {
	  	   $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
	  }
	    elseif ($filter==3)//month/year
	  {
	    $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
 	  }
	    elseif ($filter==4)//year only
	  {
	   $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
	  }
	    elseif ($filter==7) //last 6 months $fromdate$todate
	  {
	   $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
	  }
	     elseif ($filter==8) //all
	  {
	   $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE cond='1'  ";
	  }




$result = $this->db->query($query_str);

$ptype = $result->result_array();

$returnable = array('ptype'=>$ptype);
return $returnable;







}





}
?>