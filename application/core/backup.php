<?php
if (!defined('BASEPATH'))
	exit('No direct script access allowed');

class overall extends MY_Controller {

    var $previousmonth;
    var $currentyear;
    var $tnat;
    var $tt;
    var $age;
    var $gender;
    var $hstatus;
    var $ptype;
    var $filter;
    var $currentmonth;
    var $fromfilter;
    var $tofilter;
    var $fromdate;
    var $todate;
    var $title;
    var $total;
    var $mtb;
    var $neg;
    var $rif; 
    var $notb;
    var $totaltt;
    var $MTBpositive;
    var $MTBnegative;
    var $rifRes;   
    var $mwezi;
    var $mwaka; 
    var $mtbabove;
    var $mtbbelow;
    var $mtbbtwn;
    
    


        function __construct() {
                parent::__construct();
               
                $this->previousmonth= @date("m")- 1 ;
                $this->currentyear= @date("Y");
                $this->total = $this->overall_logged();
                $this->mtb = $this->overall_logged();
                $this->notb = $this->overall_logged();
                $this->rif = $this->overall_logged();


                $this->mwaka=$this->header_var($this->mwaka,$this->mwezi,$this->filter);
                $this->mwezi=$this->header_var($this->mwaka,$this->mwezi,$this->filter);
                $this->filter=$this->header_var($this->filter,$this->mwaka,$this->mwezi);
                $this->fromfilter=$this->header_var($this->filter,$this->mwaka,$this->mwezi);
                $this->tofilter=$this->header_var($this->filter,$this->mwaka,$this->mwezi);
                $this->fromdate=$this->header_var($this->filter,$this->mwaka,$this->mwezi);
                $this->todate=$this->header_var($this->filter,$this->mwaka,$this->mwezi);
                $this->title=$this->header_var($this->filter,$this->mwaka,$this->mwezi);
                $this->mwaka=$this->header_var($this->mwaka,$this->mwezi,$this->filter);
                $this->mwezi=$this->header_var($this->mwaka,$this->mwezi,$this->filter);

                $this->totaltt = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
                $this->MTBpositive = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
                $this->MTBnegative = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
                $this->rifRes = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;

                $this->mtbabove = $this->totalTestsNational($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate);
                $this->mtbbtwn = $this->totalTestsNational($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate);
                $this->mtbbelow = $this->totalTestsNational($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate);
              
                $this->tnat=$this->totalTestsNational($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate);
                $this->tt= $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
                $this->age=$this->totalTestsByAge($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate); 
                $this->gender=$this->totalTestsByGender($this->filter, $this->currentmonth, $this->currentyear, $this->fromfilter, $this->tofilter, $this->fromdate, $this->todate);
                $this->hstatus=$this->totalTestsByHStatus($this->filter, $this->currentmonth, $this->currentyear, $this->fromfilter, $this->tofilter, $this->fromdate, $this->todate);
                $this->ptype=$this->totalTestsByPtype($this->filter, $this->currentmonth, $this->currentyear, $this->fromfilter, $this->tofilter, $this->fromdate, $this->todate);
                 

            }



	public function index(){



		$data['category'] = $this->session->userdata('category');
        $data['user'] = $this->session->userdata('user');
        $data['name'] = $this->session->userdata('name');

        $data['minY'] = $this->GetMaxYear();
        $data['maxY'] = $this->GetMinYear();

        $data['currentyear'] = $this->overall_ca();
        $data['previousmonth'] = $this->overall_ca();

        $data['total'] = $this->overall_logged();   
        $data['mtb'] = $this->overall_logged();
        $data['neg'] = $this->overall_logged();
        $data['rif'] = $this->overall_logged();
        
        $data['title'] = $this->header_var($this->filter,$this->mwaka,$this->mwezi);

        $data['title'] = $this->header_var($this->filter,$this->mwaka,$this->mwezi);
        $data['filter'] = $this->header_var($this->filter,$this->mwaka,$this->mwezi);
        $data['fromfilter'] = $this->header_var($this->filter,$this->mwaka,$this->mwezi);
        $data['tofilter'] = $this->header_var($this->filter,$this->mwaka,$this->mwezi);
        $data['fromdate'] = $this->header_var($this->filter,$this->mwaka,$this->mwezi);
        $data['todate'] = $this->header_var($this->filter,$this->mwaka,$this->mwezi);
   
        $data['totaltt'] = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;   
        $data['MTBpositive'] = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
        $data['MTBnegative'] = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
        $data['rifRes'] = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
     
        $data['tnat'] = $this->totalTestsNational($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate);
        $data['tt'] = $this->totalTestsByOutcome($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate) ;
        $data['age'] = $this->totalTestsByAge($this->filter,$this->currentmonth,$this->currentyear,$this->fromfilter,$this->tofilter,$this->fromdate,$this->todate); 
        $data['gender'] = $this->totalTestsByGender($this->filter, $this->currentmonth, $this->currentyear, $this->fromfilter, $this->tofilter, $this->fromdate, $this->todate);
        $data['hstatus'] = $this->totalTestsByHStatus($this->filter, $this->currentmonth, $this->currentyear, $this->fromfilter, $this->tofilter, $this->fromdate, $this->todate);
        $data['ptype'] = $this->totalTestsByPtype($this->filter, $this->currentmonth, $this->currentyear, $this->fromfilter, $this->tofilter, $this->fromdate, $this->todate);


        echo "<pre>";
        print_r($data);die();


        $this->load->load_pm('template/body',$data);



	

	}

   // $this->form_validation->set_rules('filter', 'Filter', 'required|callback_value_check');

    public function header_var($mwaka=null,$mwezi=null,$filter=null){

        if($mwaka==null){
           $mwaka=date('Y');
        }
        
        if($mwezi==null){
           $mwezi=date('m');
        }
        
        if($filter==null){
           $filter=0;
        }
                               
        $mwezi = substr("mwezi",0 );
        
        
                        
        
                     
        if (isset($filter)) {
            
            if ($filter == 1)//LAST 3 MONTHS
            {
                $todate = @date("Y-m-d");
                // current date
                $fromdate = @date('Y-m-d', strtotime('-3 month'));
                $displayfromdate = @date("d-M-Y", strtotime($this->fromdate));
                $displaytodate = @date("d-M-Y", strtotime($this->todate));
                $title = "Last 3 Months";
                $currentmonth = @date("m");
                $currentyear = @date("Y");
                $colspan = 3;
                $mapwidth = 540;

            } elseif ($filter == 7)//last 6 months
            {
                $todate = @date("Y-m-d");
                // current date
                $fromdate = @date('Y-m-d', strtotime('-6 month'));
                $displayfromdate = @date("d-M-Y", strtotime($this->fromdate));
                $displaytodate = @date("d-M-Y", strtotime($this->todate));
                $title = "Last 6 Months";
                $currentmonth = @date("m");
                $currentyear = @date("Y");
                $colspan = 6;
                $mapwidth = 540;
            } elseif ($filter == 0)//last submission

            {
                
                
                // $filter = 0;
                $colspan = 6;
                $mapwidth = 540;
                $currentmonth = $this->GetMaxMonthbasedonMaxYear($this->mwezi);
                $displaymonth = $this->GetMonthName($this->currentmonth);
                $currentyear = $this->GetMaxYear($this->mwaka);
                $title = "Last Upload :" . $displaymonth . ' - ' . $currentyear;
                //get current month and year
            } elseif ($filter == 3)//month/year
            {
                $displaymonth =$this->GetMonthName($this->mwezi);
                $title = $displaymonth . ' - ' . $mwaka;
                //get current month and year
                $currentmonth = $mwezi;
                $currentyear = $mwaka;
                $colspan = 1;
                $mapwidth = 540;
            } elseif ($filter == 4)//year
            {
                $title = $mwaka;
                //get current month and year
                $currentmonth = "";
                //get current month and year
                $currentyear = $mwaka;
                $colspan = 12;
                $mapwidth = 400;
            }
            elseif ($filter == 8)//all
            {
                $currentmonth = $this->GetMaxMonthbasedonMaxYear($this->mwezi);
                $currentyear = GetMaxYear($this->mwaka);
                $displaymonth = $this->GetMonthName($this->currentmonth);
                $minyear = GetMinYear();
                $title = "Cumulative Data : " . $minyear . ' to ' . $displaymonth . ' - ' . $currentyear;
                
            }
        } else {
            if ($this->input->get('submitform',TRUE)){
                $filter = 2;
                $fromfilter = $_GET['fromfilter'];
                $tofilter = $_GET['tofilter'];
                $displayfromfilter = @date("d-M-Y", strtotime($fromfilter));
                $displaytofilter = @date("d-M-Y", strtotime($tofilter));
                $title = $displayfromfilter . "  to  " . $displaytofilter;
                $currentmonth = @date("m");
                $currentyear = @date("Y");
                $colspan = 1;
                $mapwidth = 540;
            } else {
                if (isset($mwaka)) {
                if (isset($mwezi)) {
                    $filter = 3;
                    $displaymonth = $this->GetMonthName($this->mwezi);
                    $title = $displaymonth . ' - ' . $mwaka;
                    //get current month and year
                    $currentmonth = $mwezi;
                    $currentyear = $mwaka;
                    $colspan = 1;
                    $mapwidth = 540;
                } else {
                    $filter = 4;
                    $title = $mwaka;
                    //get current month and year
                    $currentmonth = "";
                    //get current month and year
                    $currentyear = $mwaka;
                    $colspan = 12;
                    $mapwidth = 400;
                }
                } else  {   
                    $filter = 0;
                    $colspan = 6;
                    $mapwidth = 540;

                    $currentmonth = $this->GetMaxMonthbasedonMaxYear($this->samp);
                    $displaymonth = $this->GetMonthName($this->currentmonth);
                    $currentyear = $this->GetMaxYear($this->samp);
                    $title = "Last Upload :" . $displaymonth . ' - ' . $currentyear;
                    //get current month and year
                }
            }
           
           
            
        }


            $filter = $this->filter;
            $currentmonth = $this->currentmonth;
            $displaymonth = $this->displaymonth;
            $currentyear = $this->currentyear;
            $title = $this->title;
            
            $returnable = array(
                'filter'=>$filter,
                'currentmonth'=>$currentmonth,
                'displaymonth'=>$displaymonth,
                'currentyear'=>$currentyear,
                'title'=>$title
                );
            echo " <pre>";
            print_r($returnable);die();

                    // return $this->filter;
                    // return $this->currentmonth;
                    // return $this->displaymonth;
                    // return $this->currentyear;
                    // return $this->title;

}
public function overall_ca(){



            $query_str= "SELECT ID as a,name as b from countys";
            


            $result = $this->db->query($query_str)->result_array();
            
            $currentmonth=@date("m");
            $currentyear=@date("Y");
            $previousmonth=@date("m")- 1;

            if ($currentmonth ==1)
            {
            $previousmonth=12;
            $currentyear=@date("Y")-1;
            }
            else
            {
            $previousmonth=@date("m")- 1;
            $currentyear=@date("Y");
            }

            return $this->currentmonth;
            return $this->currentyear;
            return $this->previousmonth;

    


} 

public function overall_logged(){
        


        $query_str="SELECT total,mtb,neg,rif
FROM(
SELECT 

sum(CASE WHEN cond='1' THEN 1 ELSE 0 END) as total,

sum( CASE WHEN Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS mtb,

sum(CASE WHEN Test_Result =   'MTB NOT DETECTED'  THEN 1 ELSE 0 END) as neg,

sum( CASE WHEN   Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rif  


FROM sample)x" ;    



 $result = $this->db->query($query_str)->result_array();
 if( $result){
    $this->total=$result[0]['total'];
    $this->mtb=$result[0]['mtb'];
    $this->notb=$result[0]['neg'];
    $this->rif=$result[0]['rif'];
 }

 
 
   return $this->total;
   return $this->mtb;
   return $this->notb;
   return $this->rif;
        }   
        


    function totalTestsNational($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate) 
{

if ($filter==0) //last submission
      {
      $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,
sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

      }
      elseif ($filter==1)//last 6 months $fromdate$todate
      {
      $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
      }
      elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
      {
          $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
      }
        elseif ($filter==3)//month/year
      {
       $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
      }
        elseif ($filter==4)//year only
      {
     $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
      }
        elseif ($filter==7) //last 6 months $fromdate$todate
      {
          $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
      }
      elseif ($filter==8) //all
      {
          $query_str="SELECT sum(CASE WHEN (age<5) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END) as totalbelow,

sum( CASE WHEN ( age<5 ) AND ( Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' OR Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbbelow,
sum( CASE WHEN  (age<5) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifbelow,
sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END) as totalbtwn,
sum( CASE WHEN  (age Between 6 AND 15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbbtwn,
sum( CASE WHEN (age Between 6 AND 15) AND   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifbtwn,
sum(CASE WHEN (age>15) THEN 1 ELSE 0 END) as totalabove,
sum( CASE WHEN (age>15) AND  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =    'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbabove,
sum( CASE WHEN  (age>15) AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =   'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =    'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifabove,
sum(CASE WHEN (gender='Male') THEN 1 ELSE 0 END) as totalMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =     'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =     'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED' ) THEN 1 ELSE 0 END ) AS mtbMale,
sum( CASE WHEN (gender='Male') AND  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =    'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =     'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' ) THEN 1 ELSE 0 END ) AS rifMale,
sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END) as totalFemale,
sum( CASE WHEN (gender='Female') AND   (Test_Result =    'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFemale,
sum( CASE WHEN (gender='Female') AND    (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifFemale,
sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END) as totalNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNotsp,
sum( CASE WHEN (gender='Not specified') AND   (Test_Result =   'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNotsp,  
sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END) as totalPos,
sum( CASE WHEN (h_status='Positive') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbPos,
sum( CASE WHEN (h_status='Positive') and   (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifPos, 
sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END) as totalNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNeg,
sum( CASE WHEN (h_status='Negative') and  (Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifNeg,  
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') OR h_status='Declined' THEN 1 ELSE 0 END) as totalNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and (Test_Result =   'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result =  'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED') THEN 1 ELSE 0 END ) AS mtbNA,
sum( CASE WHEN (h_status='Not Done' OR h_status='Declined') and  (Test_Result =  'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result =  'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')   THEN 1 ELSE 0 END ) AS rifNA,
sum(CASE WHEN pat_type='sputum smear-positive relapse' THEN 1 ELSE 0 END) as totalsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum(CASE WHEN pat_type='sputum smear-negative relapse' THEN 1 ELSE 0 END) as totalsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum(CASE WHEN pat_type='Return after defaulting' THEN 1 ELSE 0 END) as totalReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum(CASE WHEN pat_type='Failure 1-st line treatment' THEN 1 ELSE 0 END) as totalFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN pat_type='Failure re-treatment' THEN 1 ELSE 0 END) as totalFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum(CASE WHEN pat_type='New Patients' THEN 1 ELSE 0 END) as totalNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum(CASE WHEN pat_type='New case PTB' THEN 1 ELSE 0 END) as totalNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum(CASE WHEN pat_type='MDR TB Contact' THEN 1 ELSE 0 END) as totalContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum(CASE WHEN pat_type='Refugees SS+ve' THEN 1 ELSE 0 END) as totalRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum(CASE WHEN pat_type='HCWs' THEN 1 ELSE 0 END) as totalHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum(CASE WHEN pat_type='Hiv(+) & Smear(-)' THEN 1 ELSE 0 END) as totalHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE cond='1'  ";
      }

    

$result = $this->db->query($query_str)->result_array();


// echo "<pre>";
// print_r($result);
// die();


$this->tnat = $result;


 if( $result){

    // $this->totalbelow=count($result[0]['totalbelow']);
    // $this->totalbtwn=count($result[0]['totalbtwn']);
    // $this->totalabove=count($result[0]['totalabove']);

    // $this->mtbbelow=count($result[0]['mtbbelow']);
    // $this->mtbbtwn=count($result[0]['mtbbtwn']);
    // $this->mtbabove=count($result[0]['mtbabove']);

    // $mtbabove=count($result[0]['rifbelow']);
    // $mtbabove=count($result[0]['rifbtwn']);
    // $mtbabove=count($result[0]['rifabove']);

    
    


 }

    // return $this->totalbelow;
    // return $this->totalbtwn;
    // return $this->totalabove;
 
    // return $this->mtbbelow;
    // return $this->mtbbtwn;
    // return $this->mtbabove;

    // return $rifbelow;
    // return $rifbtwn;
    // return $rifabove;     


}


public function totalTestsByOutcome($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate){

if ($filter==0) //last submission
      {
       $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END) AS totaltt,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS MTBpositive,
       sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END) AS MTBnegative,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rifRes  
       FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

      }
      elseif ($filter==1)//last 6 months $fromdate$todate
      {
       $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END) AS totaltt,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS MTBpositive,
       sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END) AS MTBnegative,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rifRes  
       FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
      }
      elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
      {
           $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END) AS totaltt,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS MTBpositive,
       sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END) AS MTBnegative,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rifRes  
       FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
      }
        elseif ($filter==3)//month/year
      {
        $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END) AS totaltt,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS MTBpositive,
       sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END) AS MTBnegative,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rifRes  
       FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
      }
        elseif ($filter==4)//year only
      {
       $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END) AS totaltt,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS MTBpositive,
       sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END) AS MTBnegative,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rifRes  
       FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
      }
        elseif ($filter==7) //last 6 months $fromdate$todate
      {
       $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END) AS totaltt,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS MTBpositive,
       sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END) AS MTBnegative,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rifRes  
       FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
      }
        elseif ($filter==8) //all
      {
       $query_str="SELECT  count(CASE WHEN cond='1' THEN 1 ELSE 0 END) AS totaltt,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance NOT DETECTED'OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR  Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR  Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED' THEN 1 ELSE 0 END ) AS MTBpositive,
       sum(CASE WHEN Test_Result = 'MTB NOT DETECTED'  THEN 1 ELSE 0 END) AS MTBnegative,
       sum( CASE WHEN Test_Result = 'MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result = 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR  Test_Result = 'MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE' THEN 1 ELSE 0 END ) AS rifRes  
       FROM  sample WHERE cond='1'  ";
      }


                                     

        $result = $this->db->query($query_str)->result_array();
            
                                    
if( $result){
    $this->totaltt=count($result[0]['totaltt']);
    $this->MTBpositive=count($result[0]['MTBpositive']);
    $this->MTBnegative=count($result[0]['MTBnegative']);
    $this->rifRes=count($result[0]['rifRes']);
 }
// else{
//     $this->totaltt=0;
//     $this->MTBpositive=0;
//     $this->MTBnegative=0;
//     $this->rifRes=0;

// }
 
 
   return $this->totaltt;
   return $this->MTBpositive;
   return $this->MTBnegative;
   return $this->rifRes;

}


public function totalTestsByAge($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate){
    if ($filter==0) //last submission
      {
       $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

      }
      elseif ($filter==1)//last 6 months $fromdate$todate
      {
       $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
      }
      elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
      {
           $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
      }
        elseif ($filter==3)//month/year
      {
        $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
      }
        elseif ($filter==4)//year only
      {
      $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
      }
        elseif ($filter==7) //last 6 months $fromdate$todate
      {
           $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
      } elseif ($filter==8) //all
      {
           $query_str="SELECT  sum(CASE WHEN age>15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 6 AND 15 THEN 1 ELSE 0 END),sum(CASE WHEN age Between 0 AND 5 THEN 1 ELSE 0 END)
              FROM  sample WHERE cond='1'  ";
      }



        $result = $this->db->query($query_str)->result_array();

        $this->age = $result;

        return $this->age;








}

public function totalTestsByGender($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
{

    if ($filter==0) //last submission
      {
       $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

      }
      elseif ($filter==1)//last 6 months $fromdate$todate
      {
       $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
      }
      elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
      {
           $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
      }
        elseif ($filter==3)//month/year
      {
        $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
      }
        elseif ($filter==4)//year only
      {
      $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
      }
        elseif ($filter==7) //last 6 months $fromdate$todate
      {
           $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
      }
         elseif ($filter==8) //all
      {
           $query_str="SELECT  sum(CASE WHEN gender='Male' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Female' THEN 1 ELSE 0 END),sum(CASE WHEN gender='Not specified' THEN 1 ELSE 0 END)

              FROM  sample WHERE cond='1'  ";
      }


 
        $result = $this->db->query($query_str)->result_array();

        $gender = $result;

        return $gender;





}




public function totalTestsByHStatus($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
      {
      if ($filter==0) //last submission
      {
       $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

      }
      elseif ($filter==1)//last 6 months $fromdate$todate
      {
       $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
      }
      elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
      {
           $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
      }
        elseif ($filter==3)//month/year
      {
        $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
      }
        elseif ($filter==4)//year only
      {
      $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
      }
        elseif ($filter==7) //last 6 months $fromdate$todate
      {
           $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
      }
      elseif ($filter==8) //all
      {
           $query_str="SELECT  sum(CASE WHEN h_status='Positive' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Negative' THEN 1 ELSE 0 END),sum(CASE WHEN h_status='Not Done' or h_status='Declined' THEN 1 ELSE 0 END)


              FROM  sample WHERE cond='1'  ";
      }


        $result = $this->db->query($query_str)->result_array();

        $hstatus = $result;

        return $hstatus;
}


public function totalTestsByPtype($filter,$currentmonth,$currentyear,$fromfilter,$tofilter,$fromdate,$todate)
{

    if ($filter==0) //last submission
      {
      $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample  WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear'";

      }
      elseif ($filter==1)//last 6 months $fromdate$todate
      {
       $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate'  AND cond='1' ";
      }
      elseif ($filter==2)//cusomtize dates $fromfiler $tofilter
      {
           $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromfilter' AND '$tofilter'  AND cond='1' ";
      }
        elseif ($filter==3)//month/year
      {
        $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE MONTH(End_Time)='$currentmonth' AND YEAR(End_Time)='$currentyear' AND cond='1'  ";
      }
        elseif ($filter==4)//year only
      {
       $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE  YEAR(End_Time)='$currentyear'  AND cond='1' ";
      }
        elseif ($filter==7) //last 6 months $fromdate$todate
      {
       $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE End_Time BETWEEN '$fromdate' AND '$todate' AND cond='1'  ";
      }
         elseif ($filter==8) //all
      {
       $query_str="SELECT sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumpos,
sum( CASE WHEN  (pat_type='sputum smear-positive relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE')  THEN 1 ELSE 0 END ) AS rifsputumpos,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbsputumneg,
sum( CASE WHEN (pat_type='sputum smear-negative relapse') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifsputumneg,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbReturn,
sum( CASE WHEN (pat_type='Return after defaulting') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifReturn,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailure,
sum( CASE WHEN (pat_type='Failure 1-st line treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailure,  
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbFailureRt,
sum( CASE WHEN (pat_type='Failure re-treatment') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifFailureRt,  
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNP,
sum( CASE WHEN (pat_type='New Patients') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNP,  
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbNewcase,
sum( CASE WHEN (pat_type='New case PTB') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifNewcase,  
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbContact,
sum( CASE WHEN (pat_type='MDR TB Contact') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifContact,  
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbRef,
sum( CASE WHEN (pat_type='Refugees SS+ve') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifRef,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHCWs,
sum( CASE WHEN (pat_type='HCWs') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHCWs,  
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance NOT DETECTED' OR 'MTB DETECTED LOW; Rif Resistance NOT DETECTED' OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance NOT DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE'  OR Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR Test_Result ='MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED')  THEN 1 ELSE 0 END ) AS mtbHivSmear,
sum( CASE WHEN (pat_type='Hiv(+) & Smear(-)') AND (Test_Result ='MTB DETECTED HIGH; Rif Resistance DETECTED' OR 'MTB DETECTED LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED MEDIUM; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance DETECTED'  OR Test_Result ='MTB DETECTED VERY LOW; Rif Resistance INDETERMINATE') THEN 1 ELSE 0 END ) AS rifHivSmear  
FROM sample WHERE cond='1'  ";
      }




        $result = $this->db->query($query_str)->result_array();

        $ptype = $result;

        return $ptype;








}


public function GetMaxYear(){
    $query_str = "SELECT max(year(End_Time)) AS maximumyear 
                  FROM sample1";
    $result = $this->db->query($query_str)->result_array();
    if($result){
        $maximumyear = $result[0]['maximumyear'];
    }else{
        $showyear=date('Y');
    }
   return $maximumyear;
}


public function GetMinYear()
{
    

    $query_str = "SELECT MIN(year(End_Time)) AS minimumyear FROM sample1 ";
    $result = $this->db->query($query_str)->result_array();

    if($result){
        $minimumyear = $result[0]['minimumyear'];
    }else{
        $showyear=date('Y');
    }
   return $minimumyear;
}


}





